<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login</title>
</head>

<body>

<!-- NOTIFIKASI (dirapihkan posisinya saja) -->
<div id="notif"></div>

<div class="login-box">

  <h1>Login</h1>

  <div class="input-group">
    <label for="username">Username</label><br>
    <input id="username" autocomplete="off" placeholder="Masukkan username...">
  </div><br>

  <div class="input-group">
    <label for="password">Password</label><br>
    <input id="password" type="password" autocomplete="new-password" placeholder="Masukkan password...">
  </div>

  <button onclick="login()">Login</button>

  <p>Belum punya akun? <a href="/register">Register</a></p>

</div>

<script>
//Script untuk mengosongkan input saat halaman dibuka
window.onload = () => {
  username.value = "";
  password.value = "";
};

// Fungsi showNotif() untuk menampilkan Notifikasi
function showNotif(text, success = true) {
  const box = document.getElementById("notif");
  box.innerText = text;


  box.style.background = success ? "#2ecc71" : "#e74c3c";

  // css untuk Notifikasi
  box.style.position = "fixed";
  box.style.top = "15px";
  box.style.left = "50%";
  box.style.transform = "translateX(-50%)";
  box.style.padding = "10px 20px";
  box.style.color = "white";
  box.style.borderRadius = "5px";
  box.style.display = "block";

  setTimeout(() => box.style.display = "none", 2000);// Auto hilang 2 detik
}

// Ambil value input 
// fungsi trim() menghapus spasi di depan/belakang.
async function login() {
  const user = username.value.trim();
  const pass = password.value.trim();

  // validasi input kosong 
  if (!user && !pass) {
    showNotif("Isi username & password terlebih dahulu!", false);
    return;
  }

  if (!user) {
    showNotif("Isi username terlebih dahulu!", false);
    return;
  }

  if (!pass) {
    showNotif("Isi password terlebih dahulu!", false);
    return;
  }

  // kirim ke server untuk login 
  const res = await fetch("/api/login", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ username: user, password: pass })
  });

  // ambil Respawn dari server
  const data = await res.json();

  showNotif(data.message, data.success);

  if (data.success) {
    setTimeout(() => {
      location.href = "/dashboard";
    }, 1200);
  }
}
</script>

</body>
</html>
