<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Register</title>
</head>
<body>

<!-- Kotak Notifikasi -->
<div id="notif" style="display:none; padding:10px; margin-bottom:10px; color:white;"></div>

<!-- Form Register -->
<div>
  <h1>Register</h1>

  <div>
    <label>Username</label><br>
    <input id="username" placeholder="Masukkan username...">
  </div>
  <br>

  <div>
    <label>Password</label><br>
    <input id="password" type="password" placeholder="Masukkan password...">
  </div>
  <br>

  <button onclick="registerUser()">Register</button>

  <p>Sudah punya akun? <a href="/login">Login</a></p>

</div>

<script>
const usernameInput = document.getElementById("username");
const passwordInput = document.getElementById("password");

function showNotif(text, success = true) {
  const box = document.getElementById("notif");
  box.innerText = text;
  box.style.background = success ? "green" : "red";
  box.style.display = "block";

  setTimeout(() => {
    box.style.display = "none";
  }, 2000);
}

async function registerUser() {
  if (!usernameInput.value || !passwordInput.value) {
    showNotif("Isi username & password dulu!", false);
    return;
  }

  try {
    const res = await fetch("/api/register", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        username: usernameInput.value,
        password: passwordInput.value
      })
    });

    const data = await res.json();
    showNotif(data.message, data.success);

    if (data.success) {
      setTimeout(() => {
        location.href = "/login";
      }, 1200);
    }

  } catch (err) {
    showNotif("Server error", false);
    console.error(err);
  }
}
</script>


</body>
</html>
