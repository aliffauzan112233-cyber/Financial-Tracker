<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Register</title>
</head>
<body>

<!-- Kotak Notifikasi -->
<div id="notif" style="display:none; padding:10px; margin-bottom:10px; color:white;"></div>

<!-- Form Register -->
<div>
  <h1>Register</h1>

  <div>
    <label>Username</label><br>
    <input id="username" placeholder="Masukkan username...">
  </div>
  <br>

  <div>
    <label>Password</label><br>
    <input id="password" type="password" placeholder="Masukkan password...">
  </div>
  <br>

  <button onclick="registerUser()">Register</button>

  <p>Sudah punya akun? <a href="/login">Login</a></p>

</div>

<script>
function showNotif(text, success = true) {
  const box = document.getElementById("notif");
  box.innerText = text;
  box.style.background = success ? "green" : "red";
  // box.style.display = "block";

  setTimeout(() => {
    box.style.display = "none";
  }, 2000);
}

// Fungsi Register
async function registerUser() {
  // Validasi jika kosong
  if (!username.value || !password.value) {
    showNotif("Isi username & password dulu!", false);
    return;
  }

  const res = await fetch("/api/register", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      username: username.value,
      password: password.value
    })
  });

  const data = await res.json();

  // Tampilkan notifikasi
  showNotif(data.message, data.success);

  if (data.success) {
    setTimeout(() => {
      location.href = "/login";
    }, 1200);
  }
}
</script>

</body>
</html>
